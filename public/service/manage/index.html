<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <link rel="icon" type="image/png" href="/images/temple-icon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥å‹™æœå‹™ç®¡ç† - é¾œé¦¬å±±æ•´åˆæœå‹™å¹³å°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/common.css">
</head>
<body>
    <div id="mainApp" style="display: none;">
        <div class="manage-layout">
            <header class="manage-header">
                <div class="manage-header-content">
                    <div class="manage-header-left">
                        <h1>ğŸ¯ ç¥å‹™æœå‹™ç®¡ç†</h1>
                        <p>ç®¡ç†ç·šä¸Šé»ç‡ˆã€æ³•æœƒå ±åç­‰ç¥å‹™æœå‹™è¨‚å–®</p>
                    </div>
                    <div class="manage-header-actions">
                        <button onclick="window.location.href='/'" class="manage-header-btn">å›é¦–é </button>
                        <button id="logoutBtn" class="manage-header-btn">ç™»å‡º</button>
                    </div>
                </div>
            </header>

            <main class="manage-main">
                <div id="userInfo" class="user-info" style="display: none;">
                    <img id="userAvatar" class="user-avatar" alt="ä½¿ç”¨è€…é ­åƒ">
                    <div class="user-details">
                        <h3 id="userName"></h3>
                        <div id="userRoles" class="user-roles"></div>
                    </div>
                </div>

                <div id="manageContent" class="manage-content">
                    <div class="function-grid">
                        <a href="/service/manage/dashboard.html" class="function-card">
                            <div class="function-icon">ğŸ“Š</div>
                            <div class="function-title">å„€è¡¨æ¿</div>
                            <div class="function-badge">âœ“ å·²ä¸Šç·š</div>
                            <div class="function-desc">ç¥å‹™çµ±è¨ˆèˆ‡æ•¸æ“šåˆ†æ</div>
                        </a>

                        <a href="/service/manage/orders.html" class="function-card">
                            <div class="function-icon">ğŸ“‹</div>
                            <div class="function-title">è¨‚å–®ç®¡ç†</div>
                            <div class="function-badge">âœ“ å·²ä¸Šç·š</div>
                            <div class="function-desc">æŸ¥çœ‹å ±åè¨‚å–®ã€è™•ç†ä»˜æ¬¾</div>
                        </a>

                        <a href="/service/manage/user_service.html" class="function-card">
                            <div class="function-icon">ğŸ‘¥</div>
                            <div class="function-title">ç¥å‹™ç”¨æˆ¶ç®¡ç†</div>
                            <div class="function-badge">âœ“ å·²ä¸Šç·š</div>
                            <div class="function-desc">ç®¡ç†ç¥å‹™ä½¿ç”¨è€…è§’è‰²æ¬Šé™</div>
                        </a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script type="module">
        import { checkAdminAuth, logout, displayUserInfo } from '/js/auth-guard.js';

        // æª¢æŸ¥ç®¡ç†å“¡æ¬Šé™ï¼ˆåªæœ‰ç¥å‹™ç®¡ç†å“¡ã€ç¥å‹™å¹¹éƒ¨ã€è¶…ç´šç®¡ç†å“¡å¯é€²å…¥ï¼‰
        checkAdminAuth(['admin_service', 'poweruser_service', 'superadmin']).then((result) => {
            console.log('âœ… [ç¥å‹™æœå‹™ç®¡ç†] ç®¡ç†å“¡èªè­‰æˆåŠŸ');
            
            if (result.authenticated) {
                const { userData } = result;
                
                const userInfo = document.getElementById('userInfo');
                const userName = document.getElementById('userName');
                const userAvatar = document.getElementById('userAvatar');
                const userRoles = document.getElementById('userRoles');

                displayUserInfo(userData, {
                    nameElement: userName,
                    avatarElement: userAvatar,
                    rolesElement: userRoles
                });

                userInfo.style.display = 'flex';

                document.getElementById('logoutBtn').addEventListener('click', logout);
            }
        });
    </script>
</body>
</html>
