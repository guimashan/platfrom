# æ•¸æ“šé·ç§»è…³æœ¬

## migrate-checkin-users.js

ç‚ºæ‰€æœ‰æœ‰ç°½åˆ°è¨˜éŒ„çš„ç”¨æˆ¶è‡ªå‹•åŠ ä¸Š `user_checkin` è§’è‰²ã€‚

### åŠŸèƒ½èªªæ˜

1. å¾ `checkin-76c77` çš„ `checkins` collection æŸ¥è©¢æ‰€æœ‰ç°½åˆ°è¨˜éŒ„
2. æå–æ‰€æœ‰ä¸é‡è¤‡çš„ç”¨æˆ¶ UID
3. åœ¨ `platform-bc783` çš„ `users` collection ç‚ºé€™äº›ç”¨æˆ¶åŠ ä¸Š `user_checkin` è§’è‰²
4. åŒæ­¥æ›´æ–° Firebase Auth çš„ Custom Claims

### åŸ·è¡Œæ­¥é©Ÿ

```bash
# 1. é€²å…¥ functions ç›®éŒ„
cd functions

# 2. ç¢ºä¿å·²å®‰è£ä¾è³´
npm install

# 3. åŸ·è¡Œè…³æœ¬
node scripts/migrate-checkin-users.js
```

### å‰ç½®éœ€æ±‚

- éœ€è¦æœ‰ `platform-bc783` å’Œ `checkin-76c77` å°ˆæ¡ˆçš„ç®¡ç†å“¡æ¬Šé™
- Firebase Admin SDK æœƒè‡ªå‹•ä½¿ç”¨ Application Default Credentials
- ç¢ºä¿å·²ç™»å…¥ Firebase CLIï¼š`firebase login`

### åŸ·è¡Œçµæœ

è…³æœ¬æœƒé¡¯ç¤ºï¼š
- æ‰¾åˆ°çš„ç°½åˆ°ç”¨æˆ¶ç¸½æ•¸
- æˆåŠŸæ›´æ–°çš„ç”¨æˆ¶æ•¸
- å·²æœ‰è§’è‰²ï¼ˆè·³éï¼‰çš„ç”¨æˆ¶æ•¸
- ç”¨æˆ¶ä¸å­˜åœ¨çš„æ•¸é‡
- éŒ¯èª¤æ•¸é‡

### æ³¨æ„äº‹é …

âš ï¸ **é€™æ˜¯ä¸€æ¬¡æ€§çš„æ•¸æ“šé·ç§»è…³æœ¬**
- åŸ·è¡Œå‰å»ºè­°å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒæ¸¬è©¦
- è…³æœ¬æœƒè‡ªå‹•è·³éå·²æœ‰ `user_checkin` è§’è‰²çš„ç”¨æˆ¶
- å¯ä»¥å®‰å…¨åœ°é‡è¤‡åŸ·è¡Œï¼ˆå†ªç­‰æ€§ï¼‰

### ç¯„ä¾‹è¼¸å‡º

```
ğŸš€ é–‹å§‹æ‰¹æ¬¡è™•ç†ï¼šç‚ºæœ‰ç°½åˆ°è¨˜éŒ„çš„ç”¨æˆ¶åŠ ä¸Š user_checkin è§’è‰²

ğŸ“Š Step 1: æŸ¥è©¢æ‰€æœ‰ç°½åˆ°è¨˜éŒ„...
âœ… æ‰¾åˆ° 25 å€‹æœ‰ç°½åˆ°è¨˜éŒ„çš„ç”¨æˆ¶

ğŸ”§ Step 2: é–‹å§‹æ›´æ–°ç”¨æˆ¶è§’è‰²...

âœ… å·²æ›´æ–°ï¼šabc123 (å¼µä¸‰) - è§’è‰²: user, user_checkin
âœ“ ç”¨æˆ¶ def456 (æå››) å·²æœ‰ user_checkin è§’è‰²
...

============================================================
ğŸ“ˆ æ‰¹æ¬¡è™•ç†å®Œæˆï¼çµ±è¨ˆçµæœï¼š
============================================================
ç¸½ç”¨æˆ¶æ•¸ï¼š       25
å·²æ›´æ–°ï¼š         15 äºº
å·²æœ‰è§’è‰²ï¼ˆè·³éï¼‰ï¼š8 äºº
ç”¨æˆ¶ä¸å­˜åœ¨ï¼š     2 äºº
è™•ç†éŒ¯èª¤ï¼š       0 äºº
============================================================

âœ… è…³æœ¬åŸ·è¡Œå®Œæˆ
```
